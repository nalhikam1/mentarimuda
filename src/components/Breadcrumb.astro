---
import { slugify } from '../utils/slugify';

const { category, title } = Astro.props;

// Schema.org JSON-LD Generation
const schemaData = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Beranda",
      "item": Astro.site ? new URL('/', Astro.site).toString() : "/"
    },
    ...(category ? [{
      "@type": "ListItem",
      "position": 2,
      "name": category,
      "item": Astro.site ? new URL(`/category/${slugify(category)}`, Astro.site).toString() : `/category/${slugify(category)}`
    }] : []),
    {
      "@type": "ListItem",
      "position": category ? 3 : 2,
      "name": title,
      "item": Astro.url.href
    }
  ]
};
---

<nav class="breadcrumb" aria-label="Breadcrumb">
  <script type="application/ld+json" set:html={JSON.stringify(schemaData)} />
  
  <a href="/" class="breadcrumb-link">Beranda</a>
  <span class="separator">›</span>
  
  {category && (
    <>
      <a href={`/category/${slugify(category)}`} class="breadcrumb-link">{category}</a>
      <span class="separator">›</span>
    </>
  )}
  
  <span class="breadcrumb-current" aria-current="page">{title}</span>
</nav>

<style>
  .breadcrumb {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.875rem;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border);
    flex-wrap: wrap;
  }

  .breadcrumb-link {
    color: var(--text-secondary);
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .breadcrumb-link:hover {
    color: var(--text);
    text-decoration: underline;
  }

  .separator {
    color: var(--text-secondary);
    font-weight: 300;
    opacity: 0.5;
  }

  .breadcrumb-current {
    color: var(--text);
    font-weight: 600;
    max-width: 400px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  @media (max-width: 640px) {
    .breadcrumb {
      font-size: 0.75rem;
      gap: 6px;
      margin-bottom: 16px;
      padding-bottom: 12px;
    }

    .breadcrumb-current {
      max-width: 200px;
    }
  }
</style>
